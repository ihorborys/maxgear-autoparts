{"version":3,"file":"index.js","sources":["../src/js/search.js"],"sourcesContent":["const DELIMITER = ';';\n// const NEW_LINE = '\\r\\n';\nconst searchInput = document.querySelector('#search');\n\n// Імітація затримки завантаження\nwindow.onload = function () {\n  setTimeout(function () {\n    document.getElementById('loader').style.display = 'none';\n    document.getElementById('content').style.display = 'block';\n  }, 2000); // 2 секунди затримки\n};\n\n// Відкриття модального вікна пошуку\nconst catalogButton = document.querySelector('.search.button');\nconst modalSearch = document.querySelector('.modal-overlay');\n\ncatalogButton.addEventListener('click', event => {\n  modalSearch.classList.add('active');\n});\n\n// Закриття модального вікна пошуку\nconst closeButton = document.querySelector('.modal-close-btn');\n\ncloseButton.addEventListener('click', event => {\n  modalSearch.classList.remove('active');\n});\n\n// Автоматично завантажуємо файл за URL\n// const fileURL = '../public/PRICE AP_GDANSK_MOTOROL_ 13.01.2024_R_utf_8.csv'; // Замінити на шлях до файлу\nconst fileURL =\n  'https://raw.githubusercontent.com/ihorborys/vite-maxgear-autoparts/gh-pages/PRICE%20AP_GDANSK_MOTOROL_%2013.01.2024_R_utf_8.csv'; // Замінити на шлях до файлу\n\nconst readPrice = () => {\n  // Показуємо лоадер для прайсу до його завантаження\n  document.getElementById('loader').style.display = 'block'; // Показуємо лоадер прайсу\n\n  fetch(fileURL)\n    .then(response => response.text())\n    .then(data => {\n      parseCSV(data); // Парсимо CSV\n      document.getElementById('loader').style.display = 'none'; // Сховуємо лоадер після завантаження\n    })\n    .catch(error => {\n      alert('Error loading file: ' + error);\n      document.getElementById('loader').style.display = 'none'; // Сховуємо лоадер при помилці\n    });\n};\n\n// Парсинг файлу\nconst items = [];\nconst parseCSV = csvData => {\n  const rows = csvData.split(/\\r?\\n/);\n  rows.shift(); // Видалити перший рядок (заголовки)\n  rows.forEach(row => {\n    const splitRow = row.split(DELIMITER);\n    items.push({\n      code: splitRow[0],\n      unicode: splitRow[1],\n      brand: splitRow[2],\n      desc: splitRow[3],\n      qty: splitRow[4],\n      price: splitRow[5],\n      store: splitRow[6],\n    });\n  });\n  console.log('Дані завантажені:', items);\n};\n\n// // Функція затримки виконання пошуку\n// function debounce(func, delay) {\n//     let timeout;\n//     return (...args) => {\n//         clearTimeout(timeout); // Очищаємо попередній таймер\n//         timeout = setTimeout(() => func(...args), delay); // Встановлюємо новий\n//     };\n// }\n\n// Форматування коду введення\nfunction formatCode(rawCode) {\n  return rawCode.toLowerCase().replace(/[^a-zA-Z0-9]/g, '');\n}\n\n// Пошук з затримкою виконання\nlet searchTimeout;\n\nsearchInput.addEventListener('input', event => {\n  clearTimeout(searchTimeout); // Скидаємо попередній таймер\n\n  searchTimeout = setTimeout(() => {\n    if (items.length === 0) {\n      alert('Зачекайте, будь ласка, дані завантажуються'); // Переробити\n      return;\n    }\n\n    if (event.target.value) {\n      const searchCode = formatCode(event.target.value);\n      console.log(searchCode);\n\n      const result = items.filter(\n        item =>\n          (item.code && formatCode(item.code) === searchCode) ||\n          (item.unicode && formatCode(item.unicode) === searchCode) ||\n          (item.brand && formatCode(item.brand) === searchCode)\n      );\n      console.log(result);\n      displayResults(result);\n    }\n  }, 800);\n});\n\n// // Очищення input при кліку на вільному полі\n// document.addEventListener('click', event => {\n//   if (!searchInput.contains(event.target)) {\n//     // Якщо клік НЕ в межах input\n//     searchInput.value = ''; // Очищаємо поле\n//   }\n// });\n\n// Відображення результатів\nconst keyMapping = {\n  code: 'Код',\n  unicode: 'Юнікод',\n  brand: 'Бренд',\n  desc: 'Опис',\n  price: 'Ціна, Є',\n  qty: 'Кількість',\n  store: 'Склад',\n};\n\nfunction displayResults(result) {\n  console.log(typeof result);\n  const resultsDiv = document.getElementById('results');\n\n  if (!resultsDiv) {\n    console.error('Елемент #results не знайдено.');\n    return;\n  }\n\n  if (!Array.isArray(result)) {\n    alert('Введіть дані для пошуку');\n    return;\n  }\n\n  const maxItems = 10; // Максимальна кількість позицій\n  resultsDiv.innerHTML = result\n    .slice(0, maxItems) // Беремо лише перші maxItems елементів\n    .map(\n      row => `\n      <div class=\"searched-item\"\">\n        ${\n          typeof row === 'object' && row !== null\n            ? Object.entries(row)\n                .map(([key, value]) => {\n                  const displayKey = keyMapping[key] || key; // Замінюємо ключ або залишаємо як є\n                  return `<p><strong>${displayKey}:</strong> &nbsp ${value}</p>`;\n                })\n                .join('')\n            : `<p>${row}</p>`\n        }\n      </div>\n    `\n    )\n    .join('');\n}\n\n// Додавання вибраник елементів в кошик\n\nreadPrice();\n"],"names":["DELIMITER","searchInput","catalogButton","modalSearch","event","closeButton","fileURL","readPrice","response","data","parseCSV","error","items","csvData","rows","row","splitRow","formatCode","rawCode","searchTimeout","searchCode","result","item","displayResults","keyMapping","resultsDiv","maxItems","key","value"],"mappings":"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"}